# 更新日志

## 1.0.5 (2025-02-15)

### 修复
- 优化日志输出，降低过程噪音日志级别到debug
- 移除play_song_by_number中的冗余re.match
- 修复关键字提取方式，使用更精确的前缀移除
- 修复self._http_session可能为None的竞态问题
- 切换音源时更新会话时间戳
- 修复下载超限时的临时文件泄漏
- 改进下载失败的错误反馈
- 修复SSRF风险，禁用重定向并校验重定向链
- 修复私网网段判断不准确问题
- 修复临时文件名拼接的路径注入风险
- 改进Content-Type校验，不允许空值

### 改进
- 添加会话状态后台清理机制
- 添加并发限制，防止DoS攻击
- 增加请求超时时间到120秒

## 1.0.4 (2025-02-15)

### 修复
- 修复由于上个版本修复了一堆bug导致播放失败的问题（现在我脸黑到想给人炸了）

## 1.0.3 (2025-02-15)

### 修复
- 修了若干个bug（挺多就不列举了）
- 添加详细的日志输出，方便调试和问题排查

### 改进
- 代码质量优化
- 添加详细的函数注释和文档字符串
- 改进错误处理，提供更友好的用户提示

## 1.0.2 (2025-02-15)

### 变更
- 简化播放指令，仅保留 `点歌x` 格式
- 移除 `点歌第一个`、`点歌第x个`、`点歌第x首` 指令（指令太多，不想修）

### 指令
- `点歌x` - 播放第x首歌曲（x为数字，如：点歌1、点歌2），在此前提需要先点歌（例如：点歌 起风了）才有效

## 1.0.1 (2025-02-14)

### 新增功能
- 后台配置搜索结果数量

### 配置
- **搜索结果显示数量**：搜索结果显示的歌曲数量（5-30）

### 依赖
- aiohttp >= 3.8.0
- pydub >= 0.25.1
- FFmpeg（自动检测）

### 修复
- 优化 FFmpeg 自动检测（跨平台支持）
- 修复播放地址获取逻辑
- 增强错误处理和日志记录
